# My Notes 部署与配置指南

本指南将介绍如何部署 **My Notes** 笔记浏览器，并将其连接到您的 GitHub 公有或私有笔记仓库。

---

## 快速开始

My Notes 是一个纯静态网页应用，无需构建工具或后端服务器，只需几分钟即可部署到 GitHub Pages。

**项目结构**：
```
my-notes/
├── index.html      # 主入口文件
├── css/
│   └── styles.css  # 样式文件
├── js/
│   ├── main.js     # 入口模块
│   ├── config.js   # 配置管理
│   ├── data.js     # 数据获取
│   └── ui.js       # 界面渲染
└── start.bat       # 本地调试启动脚本
```

---

## 1. 部署到 GitHub Pages

### 第一步：创建仓库

在 GitHub 上创建一个新仓库（例如名为 `my-notes`）

### 第二步：上传文件

将以下文件/文件夹上传到仓库根目录：
- `index.html`
- `css/` 文件夹
- `js/` 文件夹

### 第三步：启用 GitHub Pages

1. 进入仓库的 **Settings** → **Pages**
2. 在 **Build and deployment** 下选择：
   - Source: `Deploy from a branch`
   - Branch: `main` (或 `master`)
   - Folder: `/ (root)`
3. 点击 **Save**

### 第四步：访问您的网站

几分钟后，GitHub 会提供访问链接：

```
https://<您的用户名>.github.io/<仓库名>/
```

---

## 2. 连接公有笔记仓库

如果您的笔记保存在一个**公开**的 GitHub 仓库中，配置非常简单。

### 方式 A：通过界面配置

1. 打开部署好的网页
2. 点击右上角的 **⚙ (配置)** 图标
3. 填写以下信息：
   - **GitHub 用户名/组织**：例如 `ShingWha`
   - **仓库名称**：例如 `notes-content`
   - **根目录路径** (可选)：如果笔记在某个文件夹下（如 `docs`），请填写
4. 点击 **保存并刷新**

### 方式 B：通过 URL 参数直接访问

您可以通过 URL 参数直接访问特定笔记仓库：

```
https://<您的网站地址>/?user=用户名&repo=仓库名&path=文件夹
```

---

## 3. 连接私有笔记仓库

如果您的笔记保存在**私有**仓库中，需要生成 GitHub Personal Access Token (PAT) 来授权访问。

### 第一步：生成 GitHub Token

1. 访问 GitHub [Fine-grained personal access tokens](https://github.com/settings/tokens?type=beta) (推荐)
2. 点击 **Generate new token**
3. 设置 Token 名称和有效期
4. **Repository access**: 选择 **Only select repositories** 并选中您的笔记仓库
5. **Permissions**:
   - 在 **Repository permissions** 中，找到 **Contents**，选择 **Access: Read-only**
   - **Metadata** 会被自动设为只读
6. 生成并**复制**该 Token（它只会显示一次）

### 第二步：在 My Notes 中配置

1. 打开网页，进入 **⚙ (配置)**
2. 填写用户名和仓库名
3. 在 **GitHub Token** 框中粘贴刚才生成的 Token
4. 点击 **保存并刷新**

> **安全提示**：Token 仅保存在您浏览器的 `localStorage` 中，不会上传到任何服务器。但在公共电脑上使用时请注意清理缓存。

---

## 4. 进阶功能

### 自动识别仓库

如果您将 `index.html` 部署在笔记仓库本身的 `gh-pages` 分支上，应用会自动识别当前用户名和仓库名，实现"零配置"开箱即用。

### 链接分享

利用 URL 参数或 Hash 快速分享特定笔记：

- **参数方式**：`?user=用户名&repo=仓库名&path=路径`
- **Hash 方式**：`#/{用户名}/{仓库名}/{路径}`
  - 示例：`https://shingwha.github.io/my-notes/#/ShingWha/my-notes/notes`

### 主题切换

支持 14 种主题配色：
- **模式**：Light / Dark
- **颜色**：蓝、绿、紫、橙、红、粉、玫瑰

点击侧边栏顶部的调色板图标即可切换主题。

### 搜索快捷键

- 按下 `Ctrl + F` (或 `Cmd + F`) 可快速聚焦搜索框
- 搜索支持模糊匹配文件名

### 数学公式与代码高亮

- 使用 **KaTeX** 渲染数学公式（支持 `$$...$$` 和 `$...$` 语法）
- 使用 **Prism.js** 高亮代码（支持 Bash、JavaScript、TypeScript、Python、Markdown）

---

## 5. 本地调试（开发者）

在部署到 GitHub Pages 之前，您可以在本地进行调试和预览。

### 使用 start.bat（推荐）

**使用步骤**：
1. 双击运行 `start.bat`
2. 浏览器会自动打开 `http://localhost:8080`
3. 按 `Ctrl + C` 停止服务器

**环境要求**：
- Python 3.x 或 Node.js（已安装且在 PATH 中）

---

### 手动启动服务器

如果您已安装 Python 或 Node.js，也可以手动运行：

**Python**：
```bash
python -m http.server 8080
```

**Node.js**：
```bash
npx http-server -p 8080
```

然后访问 `http://localhost:8080`

---

### 使用 VS Code

安装 **Live Server** 扩展后：
1. 右键点击 `index.html`
2. 选择 "Open with Live Server"

---

## 常见问题

**Q: 内容加载失败怎么办？**

A: 请检查：
- 网络连接是否正常（是否能访问 api.github.com）
- Token 权限是否正确设置
- 用户名和仓库名是否填写正确

**Q: API 速率限制怎么办？**

A: GitHub 对匿名请求有严格的速率限制。如果频繁刷新，建议配置 Token 以增加配额（即使是公有仓库）。

**Q: 为什么本地打开 `index.html` 无法使用？**

A: 由于浏览器安全策略（CORS），应用需要通过 HTTP 服务器运行。请使用 `start.bat` 或手动启动本地服务器。
