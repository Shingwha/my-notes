# My Notes 部署与配置指南

本指南将介绍如何部署 **My Notes** 笔记浏览器，并将其连接到您的 GitHub 公有或私有笔记仓库。

---

## 快速开始

My Notes 是一个静态网页应用，只需几分钟即可部署到 GitHub Pages。您可以选择两个版本：

| 版本 | 文件 | 特点 | 推荐场景 |
|------|------|------|----------|
| **新版** | `index.html` + `css/` + `js/` | 代码分离，易于维护和自定义 | 长期使用、需要自定义 |
| **旧版** | `index_old.html` | 单文件，所有功能集成 | 快速测试、开箱即用 |

---

## 1. 部署到 GitHub Pages

### 第一步：创建仓库

在 GitHub 上创建一个新仓库（例如名为 `my-notes`）

### 第二步：上传文件

根据您选择的版本，上传对应文件到仓库根目录：

**新版（推荐）**：
- 上传 `index.html`
- 上传 `css` 文件夹
- 上传 `js` 文件夹

**旧版**：
- 将 `index_old.html` 改名为 `index.html`
- 上传该文件

### 第三步：启用 GitHub Pages

1. 进入仓库的 **Settings** → **Pages**
2. 在 **Build and deployment** 下选择：
   - Source: `Deploy from a branch`
   - Branch: `main` (或 `master`)
   - Folder: `/ (root)`
3. 点击 **Save**

### 第四步：访问您的网站

几分钟后，GitHub 会提供访问链接：

```
https://<您的用户名>.github.io/<仓库名>/
```

---

## 2. 连接公有笔记仓库

如果您的笔记保存在一个**公开**的 GitHub 仓库中，配置非常简单。

### 方式 A：通过界面配置

1. 打开部署好的网页
2. 点击右上角的 **⚙ (配置)** 图标
3. 填写以下信息：
   - **GitHub 用户名/组织**：例如 `ShingWha`
   - **仓库名称**：例如 `notes-content`
   - **根目录路径** (可选)：如果笔记在某个文件夹下（如 `docs`），请填写
4. 点击 **保存并刷新**

### 方式 B：通过 URL 参数直接访问

您可以通过 URL 参数直接访问特定笔记仓库：

```
https://<您的网站地址>/?user=用户名&repo=仓库名&path=文件夹
```

---

## 3. 连接私有笔记仓库

如果您的笔记保存在**私有**仓库中，需要生成 GitHub Personal Access Token (PAT) 来授权访问。

### 第一步：生成 GitHub Token

1. 访问 GitHub [Fine-grained personal access tokens](https://github.com/settings/tokens?type=beta) (推荐)
2. 点击 **Generate new token**
3. 设置 Token 名称和有效期
4. **Repository access**: 选择 **Only select repositories** 并选中您的笔记仓库
5. **Permissions**: 
   - 在 **Repository permissions** 中，找到 **Contents**，选择 **Access: Read-only**
   - **Metadata** 会被自动设为只读
6. 生成并**复制**该 Token（它只会显示一次）

### 第二步：在 My Notes 中配置

1. 打开网页，进入 **⚙ (配置)**
2. 填写用户名和仓库名
3. 在 **GitHub Token** 框中粘贴刚才生成的 Token
4. 点击 **保存并刷新**

> **安全提示**：Token 仅保存在您浏览器的 `localStorage` 中，不会上传到任何服务器。但在公共电脑上使用时请注意清理缓存。

---

## 4. 进阶功能

### 自动识别仓库

如果您将 `index.html` 部署在笔记仓库本身的 `gh-pages` 分支上，应用会自动识别当前用户名和仓库名，实现"零配置"开箱即用。

### 链接分享

利用 URL 参数或 Hash 快速分享特定笔记：

- **参数方式**：`?user=用户名&repo=仓库名&path=路径`
- **Hash 方式**：`#/{用户名}/{仓库名}/{路径}`
  - 示例：`https://shingwha.github.io/my-notes/#/ShingWha/my-notes/notes`

### 搜索快捷键

- 按下 `Ctrl + F` (或 `Cmd + F`) 可快速聚焦搜索框
- 搜索支持模糊匹配文件名

---

## 5. 本地调试（开发者）

在部署到 GitHub Pages 之前，您可以在本地进行调试和预览。

### 旧版 - 最简单（双击即用）

旧版 `index_old.html` 是单文件版本，所有依赖都通过 CDN 加载：

**使用方法**：
1. 直接双击 `index_old.html`
2. 文件会在浏览器中打开，即可使用

**优点**：
- 无需安装任何环境（Python/Node.js）
- 无需启动服务器
- 开箱即用，适合快速测试

---

### 新版 - 使用 start.bat（推荐）

新版采用代码分离结构（`index.html` + `css/` + `js/`），需要通过 HTTP 服务器运行：

**使用步骤**：
1. 双击运行 `start.bat`
2. 浏览器会自动打开 `http://localhost:8080`
3. 按 `Ctrl + C` 停止服务器

**环境要求**：
- Python 3.x 或 Node.js（已安装且在 PATH 中）

---

### 手动启动服务器（新版）

如果您已安装 Python 或 Node.js，也可以手动运行：

**Python**：
```bash
python -m http.server 8080
```

**Node.js**：
```bash
npx http-server -p 8080
```

然后访问 `http://localhost:8080`

---

### 使用 VS Code（新版）

安装 **Live Server** 扩展后：
1. 右键点击 `index.html`
2. 选择 "Open with Live Server"

---

## 常见问题

**Q: 内容加载失败怎么办？**

A: 请检查：
- 网络连接是否正常（是否能访问 api.github.com）
- Token 权限是否正确设置
- 用户名和仓库名是否填写正确

**Q: API 速率限制怎么办？**

A: GitHub 对匿名请求有严格的速率限制。如果频繁刷新，建议配置 Token 以增加配额（即使是公有仓库）。

**Q: 旧版和新版有什么区别？**

A: 旧版是单文件版本，可以直接双击打开，适合快速测试；新版采用代码分离结构，易于维护和自定义，但需要通过 HTTP 服务器运行。
