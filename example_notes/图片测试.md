# 图片加载测试

本页面用于测试 my-notes 项目的图片加载与缓存功能。

---

## 功能说明

my-notes 支持以下图片加载方式：

| 类型 | 说明 | 是否缓存 |
|------|------|----------|
| **内部图片** | 仓库内的图片，支持相对路径 | ✅ |
| **GitHub 图片** | raw.githubusercontent.com 的图片 | ✅ |
| **外部图片** | 其他网站的图片 | ❌ |
| **Base64 图片** | 内嵌的 base64 编码图片 | ❌ |

---

## 一、内部图片（相对路径）

以下图片使用相对路径引用，位于 `assets/demo-image.svg`：

![内部示例图片](./assets/demo-image.svg)

### 特点
- 支持相对路径（如 `./assets/image.png`）
- 自动根据 Markdown 文件位置解析路径
- 缓存到 IndexedDB，刷新后秒开
- 支持公有仓库和私有仓库（需配置 Token）

---

## 二、外部图片

以下图片来自外部网站，不会被缓存：

### Placeholder 图片服务
![Placeholder 图片](https://via.placeholder.com/400x200/667eea/ffffff?text=External+Image+Test)

### Unsplash 随机图片
![Unsplash 图片](https://source.unsplash.com/random/400x200?nature)

### 特点
- 完整 URL 的外部图片直接由浏览器加载
- 不存储到缓存中
- 适合引用第三方图片资源

---

## 三、绝对路径示例

如果使用 GitHub 的完整 URL：

```
https://raw.githubusercontent.com/用户名/仓库名/分支/路径/图片.png
```

这种格式的 URL 会被自动识别并缓存。

---

## 四、缓存信息

图片缓存在浏览器的 IndexedDB 中，可以在控制台查看：

```javascript
// 查看缓存对象
window.imageCache

// 获取缓存大小
await imageCache.getSize()

// 清空所有缓存
await imageCache.clear()
```

### 缓存策略
- 缓存键格式：`{username}/{repo}/{imagePath}`
- 每次访问更新时间戳
- 7 天未访问的缓存自动清理
- 页面刷新后缓存依然有效

---

## 五、加载状态说明

| 状态 | 视觉效果 |
|------|----------|
| **加载中** | 图片模糊显示 |
| **加载完成** | 图片正常显示 |
| **加载失败** | 虚线边框 + 错误提示 |

---

## 六、代码示例

在 Markdown 中引用图片的标准语法：

```markdown
<!-- 相对路径 -->
![图片描述](./assets/image.png)

<!-- 绝对路径 -->
![图片描述](https://raw.githubusercontent.com/user/repo/main/path/to/image.png)

<!-- 外部图片 -->
![图片描述](https://example.com/image.jpg)

<!-- 带标题 -->
![图片描述](./image.png "图片标题")
```

---

> 💡 **提示**：首次加载图片后，刷新页面即可看到缓存效果（控制台无网络请求）。
